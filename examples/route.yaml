arch:
  d_model: 512
  n_layers: 12
  norm: RMSNorm
  mix_unit:
    kind: "route"
    choices:
      - { kind: "Attention", heads: 8, groups: 4, stencil: { kind: "local", window: 512 } }
      - { kind: "Retention", heads: 8, chunk: 512, mode: "parallel" }
      - { kind: "SSM", d_state: 16, expand: 2.0 }
    router: { topk: 2, temp: 1.0, balance: 0.01 }
    merge: "Add"
  ffn: { kind: "dense", mult: 2.0, act: "swiglu" }
  pos: { kind: "rope", rope: { theta: 10000, dims: 64 } }
train: { ctx_len: 2048, dtype: fp16 }

